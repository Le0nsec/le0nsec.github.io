<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Crypto_notes - Leon&#39;s Blog</title><meta name="Description" content="Leon&#39;s Blog-Keep learning web security"><meta property="og:title" content="Crypto_notes" />
<meta property="og:description" content="一些密码学代码笔记&hellip;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://clq0.top/crypto_notes/" />
<meta property="og:image" content="https://clq0.top/logo_.jpg"/>
<meta property="article:published_time" content="2021-03-20T18:00:34+08:00" />
<meta property="article:modified_time" content="2021-03-20T18:00:34+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://clq0.top/logo_.jpg"/>

<meta name="twitter:title" content="Crypto_notes"/>
<meta name="twitter:description" content="一些密码学代码笔记&hellip;"/>
<meta name="application-name" content="Leon&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Leon&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/logo.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://clq0.top/crypto_notes/" /><link rel="prev" href="https://clq0.top/%E5%9B%9B%E5%8F%B6%E8%8D%89%E5%AE%89%E5%85%A8%E7%89%9B%E5%B9%B4ctf%E5%A4%A7%E8%B5%9B/" /><link rel="next" href="https://clq0.top/ciscn2021_writeup/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Crypto_notes",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/clq0.top\/crypto_notes\/"
        },"genre": "posts","keywords": "Crypto","wordcount":  3235 ,
        "url": "https:\/\/clq0.top\/crypto_notes\/","datePublished": "2021-03-20T18:00:34+08:00","dateModified": "2021-03-20T18:00:34+08:00","publisher": {
            "@type": "Organization",
            "name": "Leon","logo": "https:\/\/clq0.top\/logo_.jpg"},"author": {
                "@type": "Person",
                "name": "Leon"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Leon&#39;s Blog"><span class="header-title-pre">❤</span>Leon&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/links/"> Links </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Leon&#39;s Blog"><span class="header-title-pre">❤</span>Leon&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/links/" title="">Links</a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Crypto_notes</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="http://clq0.top" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Leon</a></span>&nbsp;<span class="post-category">included in <a href="/categories/notes/"><i class="far fa-folder fa-fw"></i>Notes</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-03-20">2021-03-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;3235 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;7 minutes&nbsp;<span id="/crypto_notes/" class="leancloud_visitors" data-flag-title="Crypto_notes">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#密码学学习笔记">密码学学习笔记</a>
      <ul>
        <li><a href="#transposition_cipher">Transposition_Cipher</a></li>
        <li><a href="#affine_cipher">Affine_Cipher</a></li>
        <li><a href="#playfair_cipher">Playfair_Cipher</a></li>
        <li><a href="#hill_cipher">Hill_Cipher</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>一些密码学代码笔记&hellip;</p>
<h2 id="密码学学习笔记">密码学学习笔记</h2>
<h3 id="transposition_cipher">Transposition_Cipher</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#Python3</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">class</span> <span class="nc">Transposition</span><span class="p">:</span>
    <span class="n">__key</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># 密钥</span>
    <span class="n">__plaintext</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>  <span class="c1"># 明文</span>
    <span class="n">__encryptMsg</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>  <span class="c1"># 密文</span>
    <span class="n">__decryptMsg</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>  <span class="c1"># 解密后明文</span>
    <span class="n">__lenKey</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 密钥长度 周期值</span>

    <span class="k">def</span> <span class="nf">getKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>  <span class="c1"># 密钥形成函数</span>
        <span class="n">Key</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">antiKey</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[()]&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>  <span class="c1"># 以()分界</span>
        <span class="k">while</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>  <span class="c1"># 消除&#39;&#39;</span>
            <span class="n">s</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">Key</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># 密钥字典</span>
                <span class="n">antiKey</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>  <span class="c1"># 反密钥字典</span>
                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>  <span class="c1"># 钥匙收录</span>
            <span class="n">Key</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># 解决最后一个的问题</span>
            <span class="n">antiKey</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">maxtemp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>  <span class="c1"># 密钥长度</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__lenKey</span> <span class="o">=</span> <span class="n">maxtemp</span>
        <span class="n">lenKey</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxtemp</span><span class="p">)}</span>
        <span class="n">sameKey</span> <span class="o">=</span> <span class="n">lenKey</span><span class="o">-</span><span class="nb">set</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>  <span class="c1"># 找到没有变化的密钥</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sameKey</span><span class="p">:</span>
            <span class="n">Key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">antiKey</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">antiKey</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>  <span class="c1"># 加密函数</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plaintext</span> <span class="o">=</span> <span class="n">p</span>
        <span class="n">Key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lenKey</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># 去除空格</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">time</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="n">time</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">time</span><span class="p">)</span>  <span class="c1"># 末尾补齐</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">//</span><span class="n">time</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">time</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">time</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>  <span class="c1"># 分组生成</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">Key</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">time</span><span class="p">)]</span>  <span class="c1"># 矩阵转换</span>
        <span class="n">M</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>  <span class="c1"># 列表转换为字符串</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__encryptMsg</span> <span class="o">=</span> <span class="n">M</span>
        <span class="k">return</span> <span class="n">M</span>

    <span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lenKey</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">//</span><span class="n">m</span>
        <span class="n">Key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">m</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">Key</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
        <span class="n">M</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__decryptMsg</span> <span class="o">=</span> <span class="n">M</span>
        <span class="k">return</span> <span class="n">M</span>

    <span class="k">def</span> <span class="nf">Print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;密钥：&#34;</span><span class="p">,</span> <span class="n">Key</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;明文：&#34;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plaintext</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;密文：&#34;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__encryptMsg</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;解密后明文：&#34;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__decryptMsg</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;密钥长度：&#34;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lenKey</span><span class="p">)</span>


<span class="n">Key</span> <span class="o">=</span> <span class="s1">&#39;(1425367)&#39;</span>
<span class="n">Plaintext</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span><span class="s2">In several distributed systems a user should only be able to access data if a user posses a certain set of credentials or attributes Currently the only method for enforcing such policies is to employ a trusted server to store the data and mediate access control However if any server storing the data is compromised then the confidentiality of the data will be compromised In this paper we present a system for realizing complex access control on encrypted data that we call ciphertext-policy attribute-based encryption By using our techniques encrypted data can be kept confidential even if the storage server is untrusted moreover our methods are secure against collusion attacks
</span><span class="s2">&#34;&#34;&#34;</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Transposition</span><span class="p">()</span>
<span class="n">a</span><span class="o">.</span><span class="n">getKey</span><span class="p">(</span><span class="n">Key</span><span class="p">)</span>
<span class="n">encryptMsg</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">Plaintext</span><span class="p">)</span>
<span class="n">decryptMsg</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encryptMsg</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">Print</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="affine_cipher">Affine_Cipher</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#Python3</span>

<span class="c1">#输入密钥</span>
<span class="k">def</span> <span class="nf">accept</span><span class="p">():</span>
    <span class="n">k1</span><span class="p">,</span><span class="n">k2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;请输入两个密钥(以空格隔开)：&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="k">while</span> <span class="n">gcd</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span> <span class="o">!=</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">k1</span><span class="p">,</span><span class="n">k2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;k1和26不互素，请重新输入密钥：&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">k1</span><span class="p">,</span><span class="n">k2</span>

<span class="c1">#判断互素</span>
<span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">m</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">m</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">k1</span><span class="o">%</span><span class="n">m</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">t</span>
    <span class="k">return</span> <span class="n">k1</span>

<span class="c1">#求逆元</span>
<span class="k">def</span> <span class="nf">niyuan</span><span class="p">(</span><span class="n">k1</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">k1</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">n</span>

<span class="c1">#加密算法</span>
<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plain</span><span class="p">):</span>
    <span class="c1">#输入密钥</span>
    <span class="n">k1</span><span class="p">,</span><span class="n">k2</span> <span class="o">=</span> <span class="n">accept</span><span class="p">()</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plain</span><span class="p">)):</span>
        <span class="c1">#小写字母</span>
        <span class="k">if</span> <span class="n">plain</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">islower</span><span class="p">():</span>
            <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(((</span><span class="nb">ord</span><span class="p">(</span><span class="n">plain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="mi">97</span><span class="p">)</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="o">+</span><span class="mi">97</span><span class="p">))</span>
        <span class="c1">#大写字母</span>
        <span class="k">elif</span> <span class="n">plain</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
            <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(((</span><span class="nb">ord</span><span class="p">(</span><span class="n">plain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="mi">65</span><span class="p">)</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="o">+</span><span class="mi">65</span><span class="p">))</span>
        <span class="c1">#其他</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cipher</span>

<span class="c1">#解密算法</span>
<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">):</span>
    <span class="c1">#输入密钥</span>
    <span class="n">k1</span><span class="p">,</span><span class="n">k2</span> <span class="o">=</span> <span class="n">accept</span><span class="p">()</span>
    <span class="c1">#逆元</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="n">niyuan</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cipher</span><span class="p">)):</span>
        <span class="c1">#小写字母</span>
        <span class="k">if</span> <span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">islower</span><span class="p">():</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="mi">97</span><span class="o">-</span><span class="n">k2</span>
            <span class="k">if</span> <span class="n">t1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">t1</span> <span class="o">+=</span><span class="mi">26</span>
            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">ny</span> <span class="o">*</span> <span class="n">t1</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="o">+</span><span class="mi">97</span><span class="p">))</span>
        <span class="c1">#大写字母</span>
        <span class="k">elif</span> <span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="mi">65</span><span class="o">-</span><span class="n">k2</span>
            <span class="k">if</span> <span class="n">t2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">t2</span> <span class="o">+=</span><span class="mi">26</span>
            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">ny</span> <span class="o">*</span> <span class="n">t2</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="o">+</span><span class="mi">65</span><span class="p">))</span>
        <span class="c1">#其他</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">plain</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> 
    <span class="k">return</span> <span class="n">plain</span>

<span class="c1">#输入一段字符串，统计各个字符出现的次数</span>
<span class="k">def</span> <span class="nf">count_str</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">alphabet</span> <span class="o">=</span> <span class="s2">&#34;a b c d e f g h i j k l m n o p q r s t u v w x y z&#34;</span>
    <span class="n">li</span> <span class="o">=</span> <span class="n">alphabet</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">li</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
        <span class="c1">#print(&#34;%s:%d&#34; % (i, n))</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">plain</span> <span class="o">=</span> <span class="s2">&#34;In several distributed systems a user should only be able to access data if a user posses a certain set of credentials or attributes Currently the only method for enforcing such policies is to employ a trusted server to store the data and mediate access control However if any server storing the data is compromised then the confidentiality of the data will be compromised In this paper we present a system for realizing complex access control on encrypted data that we call ciphertext-policy attribute-based encryption By using our techniques encrypted data can be kept confidential even if the storage server is untrusted moreover our methods are secure against collusion attacks&#34;</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">plain</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;加密后密文为：&#34;</span><span class="p">,</span> <span class="n">cipher</span><span class="p">)</span>
    <span class="n">de_plain</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;解密后明文为：&#34;</span><span class="p">,</span> <span class="n">de_plain</span><span class="p">)</span>
    <span class="n">count_plain</span> <span class="o">=</span> <span class="n">count_str</span><span class="p">(</span><span class="n">plain</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;明文统计结果为：&#34;</span><span class="p">,</span> <span class="n">count_plain</span><span class="p">)</span>
    <span class="n">count_cipher</span> <span class="o">=</span> <span class="n">count_str</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;密文统计结果为：&#34;</span><span class="p">,</span> <span class="n">count_cipher</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="playfair_cipher">Playfair_Cipher</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#Python3</span>

<span class="c1"># 5*5的矩阵, I与J同, 注意是大写的，也可以自己定义矩阵(不要重复)</span>
<span class="n">SECRET_LIST</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&#34;M&#34;</span><span class="p">,</span> <span class="s2">&#34;O&#34;</span><span class="p">,</span> <span class="s2">&#34;N&#34;</span><span class="p">,</span> <span class="s2">&#34;A&#34;</span><span class="p">,</span> <span class="s2">&#34;R&#34;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="s2">&#34;H&#34;</span><span class="p">,</span> <span class="s2">&#34;Y&#34;</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="s2">&#34;D&#34;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&#34;E&#34;</span><span class="p">,</span> <span class="s2">&#34;F&#34;</span><span class="p">,</span> <span class="s2">&#34;G&#34;</span><span class="p">,</span> <span class="s2">&#34;J&#34;</span><span class="p">,</span> <span class="s2">&#34;K&#34;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&#34;L&#34;</span><span class="p">,</span> <span class="s2">&#34;P&#34;</span><span class="p">,</span> <span class="s2">&#34;Q&#34;</span><span class="p">,</span> <span class="s2">&#34;S&#34;</span><span class="p">,</span> <span class="s2">&#34;T&#34;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&#34;U&#34;</span><span class="p">,</span> <span class="s2">&#34;V&#34;</span><span class="p">,</span> <span class="s2">&#34;W&#34;</span><span class="p">,</span> <span class="s2">&#34;X&#34;</span><span class="p">,</span> <span class="s2">&#34;Z&#34;</span><span class="p">]]</span>

<span class="c1"># 加密</span>
<span class="k">def</span> <span class="nf">encryption</span><span class="p">(</span><span class="n">clear_text</span><span class="p">):</span>
    <span class="c1"># 去除空格与逗号</span>
    <span class="n">clear_text</span> <span class="o">=</span> <span class="n">clear_text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
    <span class="n">list_clear_text</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">clear_text</span><span class="p">)</span>  <span class="c1"># 字符串转化为列表</span>
    <span class="k">print</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)</span>
    <span class="c1"># 两个字母为一组，在重复的明文字母中插入填充字母Z</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
        <span class="n">list_clear_text</span> <span class="o">=</span> <span class="n">deal_repeat</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">deal_repeat</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)</span>
    <span class="c1"># 若分组到最后一组时只有一个字母，则补充字母Z</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">list_clear_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;Z&#34;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)</span>
    <span class="c1"># 加密的核心代码</span>
    <span class="n">encryption_list</span> <span class="o">=</span> <span class="n">core_encryption</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)</span>  <span class="c1"># 返回密文列表</span>
    <span class="k">return</span> <span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">encryption_list</span><span class="p">)</span>

<span class="c1"># 处理一组字线是重复明文字母</span>
<span class="k">def</span> <span class="nf">deal_repeat</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 计算列表中有多少组是不同的</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># 列表中的第d奇数个</span>
            <span class="k">if</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">list_clear_text</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>  <span class="c1"># 第奇数个与前一个(偶数)是否相同</span>
                <span class="n">list_clear_text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&#34;Z&#34;</span><span class="p">)</span>  <span class="c1"># 有重复明文字母则插入一个填充字母Z 并且退出循环</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">list_clear_text</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">list_clear_text</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]):</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">return</span> <span class="n">list_clear_text</span><span class="p">,</span> <span class="n">flag</span>  <span class="c1"># 返回的是元组 (list_clear_text, flag)</span>

<span class="c1"># 获得字母在矩阵中的行与列</span>
<span class="k">def</span> <span class="nf">get_rows_columns</span><span class="p">(</span><span class="n">alphabet</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">alphabet</span> <span class="o">==</span> <span class="s2">&#34;I&#34;</span><span class="p">:</span>  <span class="c1"># 矩阵中只有25个字母，I同J</span>
        <span class="n">alphabet</span> <span class="o">=</span> <span class="s2">&#34;J&#34;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SECRET_LIST</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">alphabet</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>

<span class="c1"># 加密的核心代码,先找出每一组字母在5*5矩阵 的行与列</span>
<span class="k">def</span> <span class="nf">core_encryption</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">):</span>
    <span class="n">encryption_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_clear_text</span><span class="p">)):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">list_clear_text</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>  <span class="c1"># 将一组字母转为大写，因为矩阵的字母全是大写的</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">list_clear_text</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="n">x_tuple</span> <span class="o">=</span> <span class="n">get_rows_columns</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># 返回元组形式</span>
            <span class="n">y_tuple</span> <span class="o">=</span> <span class="n">get_rows_columns</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="c1"># print(x_tuple)</span>
            <span class="c1"># print(y_tuple)</span>
            <span class="k">if</span> <span class="n">x_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">y_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>  <span class="c1"># 若明文字母在矩阵中同行</span>
                <span class="n">x_secret</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][(</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span><span class="p">]</span>
                <span class="n">y_secret</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][(</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">x_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">y_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1"># 若明文字母在矩阵中同列</span>
                <span class="n">x_secret</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[(</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span><span class="p">][</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">y_secret</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[(</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span><span class="p">][</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># 若明文字母在矩阵中不同行不同列</span>
                <span class="n">x_secret</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">y_secret</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">encryption_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_secret</span><span class="p">)</span>
            <span class="n">encryption_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_secret</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">encryption_list</span>  <span class="c1"># 返回字母加密后的列表</span>

<span class="c1"># 解密核心代码，返回解密后的明文列表,密文肯定是偶数的，每一组密文字母也肯定是不同的</span>
<span class="k">def</span> <span class="nf">core_decryption</span><span class="p">(</span><span class="n">list_cipher_text</span><span class="p">):</span>
    <span class="n">decryption_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_cipher_text</span><span class="p">)):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">list_cipher_text</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">list_cipher_text</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">x_tuple</span> <span class="o">=</span> <span class="n">get_rows_columns</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># 返回元组形式</span>
            <span class="n">y_tuple</span> <span class="o">=</span> <span class="n">get_rows_columns</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">y_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>  <span class="c1"># 若密文字母在矩阵中同行</span>
                <span class="n">x_clear</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][(</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span><span class="p">]</span>
                <span class="n">y_clear</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][(</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">x_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">y_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1"># 若密文字母在矩阵中同列</span>
                <span class="n">x_clear</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[(</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span><span class="p">][</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">y_clear</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[(</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span><span class="p">][</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># 若密文字母在矩阵中不同行不同列</span>
                <span class="n">x_clear</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">y_clear</span> <span class="o">=</span> <span class="n">SECRET_LIST</span><span class="p">[</span><span class="n">y_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">x_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">decryption_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_clear</span><span class="p">)</span>
            <span class="n">decryption_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_clear</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decryption_list</span>  <span class="c1"># 返回解密后的明文列表(需进一步处理,eg:去掉Z)</span>

<span class="c1"># 解密</span>
<span class="k">def</span> <span class="nf">decryption</span><span class="p">(</span><span class="n">cipher_text</span><span class="p">):</span>
    <span class="n">cipher_text</span> <span class="o">=</span> <span class="n">cipher_text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
    <span class="n">list_cipher_text</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cipher_text</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># 将密文转化为列表</span>
    <span class="n">decryption_list</span> <span class="o">=</span> <span class="n">core_decryption</span><span class="p">(</span><span class="n">list_cipher_text</span><span class="p">)</span>  <span class="c1"># 调用函数</span>
    <span class="k">if</span> <span class="n">decryption_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;Z&#34;</span><span class="p">:</span>  <span class="c1"># 若列表最后一个元素是Z，则删除</span>
        <span class="n">decryption_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 找出列表应该删除的下标</span>
    <span class="n">delete_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">decryption_list</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 第偶数个</span>
            <span class="c1"># 不越界</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">decryption_list</span><span class="p">)</span> <span class="ow">and</span> \
                    <span class="n">decryption_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">decryption_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">decryption_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;Z&#34;</span><span class="p">:</span>
                <span class="n">delete_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1"># decryption_list.pop(i+1)</span>
    <span class="n">delete_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">delete_list</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">decryption_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decryption_list</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;Please input E for encryption or D for decryption：&#34;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">choice</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&#34;E&#34;</span> <span class="ow">and</span> <span class="n">choice</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&#34;D&#34;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&#34;Input Error&#34;</span><span class="p">)</span>
        <span class="c1"># 加密</span>
        <span class="k">if</span> <span class="n">choice</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;E&#34;</span><span class="p">:</span>
            <span class="n">clear_text</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;请输入明文:&#34;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&#34;加密成功！密文:</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">encryption</span><span class="p">(</span><span class="n">clear_text</span><span class="p">))</span>
        <span class="c1"># 解密</span>
        <span class="k">if</span> <span class="n">choice</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;D&#34;</span><span class="p">:</span>
            <span class="n">cipher_text</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;请输入密文(大写字母/偶数):&#34;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&#34;解密成功！明文:</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">decryption</span><span class="p">(</span><span class="n">cipher_text</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="hill_cipher">Hill_Cipher</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#Python3</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">secret_key</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">11</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>

<span class="n">inverse_key</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span> <span class="p">],</span>
               <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span> <span class="p">],</span>
               <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span> <span class="p">],</span>
               <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">18</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">23</span><span class="p">,</span> <span class="mi">11</span><span class="p">]]</span>

<span class="c1">#取下标值</span>
<span class="k">def</span> <span class="nf">pla_index</span><span class="p">(</span><span class="n">strs</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">strs</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">97</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1">#加密函数</span>
<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">pla</span><span class="p">):</span>
    <span class="n">pla</span> <span class="o">=</span> <span class="n">pla</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
    <span class="n">pla</span> <span class="o">=</span> <span class="n">pla</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
    <span class="n">pla</span> <span class="o">=</span> <span class="n">pla</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="c1">#秘钥的行数</span>
    <span class="n">hang_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">secret_key</span><span class="p">)</span>
    <span class="c1">#将明文根据秘钥长度分组，取下标，存入列表</span>
    <span class="n">pla_group</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pla</span><span class="p">),</span><span class="n">hang_len</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">pla</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">hang_len</span><span class="p">]</span>
        <span class="n">pla_group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pla_index</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
    <span class="c1">#矩阵相乘，结果存入result中，是一个二维数组</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pla_group</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">secret_key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span><span class="p">))</span>
    <span class="c1">#遍历result，转成密文</span>
    <span class="n">cip</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">cip</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">97</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cip</span>

<span class="c1">#解密函数</span>
<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">cip</span><span class="p">):</span>
    <span class="c1">#秘钥逆矩阵的行数</span>
    <span class="n">hang_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inverse_key</span><span class="p">)</span>
    <span class="c1">#将密文根据秘钥逆矩阵长度分组，取下标，存入列表</span>
    <span class="n">cip_group</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">cip</span><span class="p">),</span><span class="n">hang_len</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">cip</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">hang_len</span><span class="p">]</span>
        <span class="n">cip_group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pla_index</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
    <span class="c1">#矩阵相乘，结果存入result中，是一个二维数组</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cip_group</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">inverse_key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span><span class="p">))</span>
    <span class="c1">#遍历result，转成明文</span>
    <span class="n">pla</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">pla</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">97</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pla</span>

<span class="c1">#输入一段字符串，统计各个字符出现的次数</span>
<span class="k">def</span> <span class="nf">count_str</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">alphabet</span> <span class="o">=</span> <span class="s2">&#34;a b c d e f g h i j k l m n o p q r s t u v w x y z&#34;</span>
    <span class="n">li</span> <span class="o">=</span> <span class="n">alphabet</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">li</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
        <span class="c1">#print(&#34;%s:%d&#34; % (i, n))</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="s2">&#34;In several distributed systems a user should only be able to access data if a user posses a certain set of credentials or attributes Currently the only method for enforcing such policies is to employ a trusted server to store the data and mediate access control However if any server storing the data is compromised then the confidentiality of the data will be compromised In this paper we present a system for realizing complex access control on encrypted data that we call ciphertext-policy attribute-based encryption By using our techniques encrypted data can be kept confidential even if the storage server is untrusted moreover our methods are secure against collusion attacks&#34;</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;明文为：&#34;</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">)</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;加密后密文为：&#34;</span><span class="p">,</span> <span class="n">cipher</span><span class="p">)</span>
    <span class="n">deplaintext</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;解密后明文为：&#34;</span><span class="p">,</span> <span class="n">deplaintext</span><span class="p">)</span>
    <span class="n">cipher_count</span> <span class="o">=</span> <span class="n">count_str</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;密文统计结果为：&#34;</span><span class="p">,</span> <span class="n">cipher_count</span><span class="p">)</span>
    <span class="n">plaintext_count</span> <span class="o">=</span> <span class="n">count_str</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;明文统计结果为：&#34;</span><span class="p">,</span> <span class="n">plaintext_count</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2021-03-20</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://clq0.top/crypto_notes/" data-title="Crypto_notes" data-hashtags="Crypto"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://clq0.top/crypto_notes/" data-hashtag="Crypto"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://clq0.top/crypto_notes/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://clq0.top/crypto_notes/" data-title="Crypto_notes"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/crypto/">Crypto</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/%E5%9B%9B%E5%8F%B6%E8%8D%89%E5%AE%89%E5%85%A8%E7%89%9B%E5%B9%B4ctf%E5%A4%A7%E8%B5%9B/" class="prev" rel="prev" title="四叶草安全牛年CTF大赛"><i class="fas fa-angle-left fa-fw"></i>四叶草安全牛年CTF大赛</a>
            <a href="/ciscn2021_writeup/" class="next" rel="next" title="CISCN2021 Writeup">CISCN2021 Writeup<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><a>本网站由</a><a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="-blank"><img src="/upyun_logo2.png" width="4%" style="vertical-align:middle"></a><a>提供CDN加速/云存储服务</a></div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="http://clq0.top" target="_blank">Leon</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><script type="text/javascript" src="https://s9.cnzz.com/z_stat.php?id=1278765080&web_id=1278765080"></script></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/valine/Valine.min.js"></script><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":40},"comment":{"valine":{"appId":"saBpLNPwjiIGzpSf9QvvTLw3-9Nh9j0Va","appKey":"jU0L8JdQYxxwunKTXrmGV194","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"en","pageSize":10,"placeholder":"Your comment ...","recordIP":true,"visitor":true}},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
